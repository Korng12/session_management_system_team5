
<body th:replace="~{layout/main :: layout(~{::section})}">

    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h2 class="card-title mb-1">Register for the Conference</h2>
                        <p class="text-muted mb-4">Create your attendee profile to register for sessions and view your schedule.</p>

                        <!-- Flash messages -->
                        <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert" th:text="${successMessage}">
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                        <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert" th:text="${errorMessage}">
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>

                        <form th:action="@{/register}" th:method="post" class="needs-validation" novalidate id="registrationForm">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="firstName" class="form-label">First Name</label>
                                    <input type="text" class="form-control" id="firstName" name="firstName" placeholder="Jane" required aria-describedby="firstNameHelp">
                                    <div id="firstNameHelp" class="form-text">Enter your given name.</div>
                                    <div class="invalid-feedback">Please provide your first name.</div>
                                </div>
                                <div class="col-md-6">
                                    <label for="lastName" class="form-label">Last Name</label>
                                    <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Doe" required>
                                    <div class="invalid-feedback">Please provide your last name.</div>
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email Address</label>
                                    <input type="email" class="form-control" id="email" name="email" placeholder="you@example.com" required>
                                    <div class="invalid-feedback">Please enter a valid email address.</div>
                                </div>
                                <div class="col-md-6">
                                    <label for="telegramNumber" class="form-label">Telegram Number</label>
                                    <input type="tel" inputmode="tel" pattern="^\+?\d{5,15}$" class="form-control" id="telegramNumber" name="telegramNumber" placeholder="+15551234567" aria-describedby="telegramHelp" required>
                                    <div id="telegramHelp" class="form-text">Include country code, e.g. <code>+1</code>.</div>
                                    <div class="invalid-feedback">Please provide a valid phone number (5â€“15 digits, optional leading +).</div>
                                </div>
                                <div class="col-12">
                                    <label for="conferenceSession" class="form-label">Select Conference</label>
                                    <select class="form-select" id="conferenceSession" name="conferenceSession" required>
                                        <option value="" disabled selected>Select a conference</option>
                                        <option value="ai_machine_learning">AI &amp; Machine Learning Conference</option>
                                        <option value="future_of_research">Future of Research Symposium</option>
                                        <!-- Add more options as needed -->
                                    </select>
                                    <div class="invalid-feedback">Please select a conference.</div>
                                </div>
                                <div class="col-12">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="yes" id="termsCheck" required>
                                        <label class="form-check-label" for="termsCheck">I agree to the <a href="#">terms and conditions</a>.</label>
                                        <div class="invalid-feedback">You must agree before submitting.</div>
                                    </div>
                                </div>
                            </div>

                            <div class="d-grid mt-4">
                                <button id="submitBtn" class="btn btn-primary btn-lg" type="submit">
                                    <span id="submitSpinner" class="spinner-border spinner-border-sm me-2 d-none" role="status" aria-hidden="true"></span>
                                    Register
                                </button>
                            </div>

                            <div class="mt-3 text-center text-muted">
                                Already registered? <a th:href="@{/login}">Log in</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="~{fragments/footer}"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Bootstrap client-side validation + submit spinner
        (function () {
            'use strict'
            var form = document.getElementById('registrationForm');
            var submitBtn = document.getElementById('submitBtn');
            var spinner = document.getElementById('submitSpinner');

            form.addEventListener('submit', function (event) {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                } else {
                    // show spinner and disable button to avoid duplicate submits
                    submitBtn.setAttribute('disabled', 'disabled');
                    spinner.classList.remove('d-none');
                }
                form.classList.add('was-validated');
            }, false);
        })();
    </script>
</body>
